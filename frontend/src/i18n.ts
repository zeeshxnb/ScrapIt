// Lightweight i18n + preferences helpers with live updates via a window event

export type AppPreferences = {
  theme?: 'light' | 'dark' | 'auto';
  language?: 'en' | 'es' | 'fr' | 'de' | 'ar' | 'hi';
  timezone?: 'auto' | 'utc' | 'pst' | 'est';
  emailsPerPage?: number;
};

const translations: Record<string, Record<string, string>> = {
  en: {
    'nav.dashboard': 'Dashboard',
    'nav.emails': 'Emails',
    'nav.chat': 'AI Assistant',
    'nav.analytics': 'Analytics',
    'nav.settings': 'Settings',
    'app.tagline': 'Email Cleaner',

    'dashboard.title': 'Dashboard',
    'dashboard.subtitle': 'Overview of your email management',
    'dashboard.stats.total': 'Total Emails',
    'dashboard.stats.spam': 'Spam Emails',
    'dashboard.stats.unprocessed': 'Unprocessed',
    'dashboard.stats.categories': 'Categories',
    'dashboard.quickActions': 'Quick Actions',
    'dashboard.topSenders': 'Top Senders',
    'dashboard.emailCategories': 'Email Categories',
    'dashboard.noActions': 'No quick actions available',
    'dashboard.noActionsHint': 'Sync your emails to see available actions',

    'emails.title': 'Emails',
    'emails.filters': 'Filters',
    'emails.search.placeholder': 'Search emails by subject, sender, or content...',
    'emails.category': 'Category',
    'emails.label': 'Label',
    'emails.sender': 'Sender',
    'emails.spamFilter': 'Spam Filter',
    'emails.allCategories': 'All Categories',
    'emails.allLabels': 'All Labels',
    'emails.allSenders': 'All Senders',
    'emails.allEmails': 'All Emails',
    'emails.notSpam': 'Not Spam',
    'emails.spamOnly': 'Spam Only',
    'emails.clearFilters': 'Clear Filters',
    'emails.noEmails': 'No emails found',
    'emails.tryAdjust': 'Try adjusting your search or filters',
    'emails.syncToSee': 'Sync your emails to see them here',
    'emails.previous': 'Previous',
    'emails.next': 'Next',

    // Chat
    'chat.title': 'AI Assistant',
    'chat.subtitle': 'Chat with your email management assistant',
    'chat.aiPowered': 'AI Powered',
    'chat.quickActions': 'Quick Actions',
    'chat.welcome': "Hi! I'm your ScrapIt AI assistant. I can help you manage your emails with natural language commands.",
    'chat.suggest.showStats': 'Show me my email statistics',
    'chat.suggest.deleteSpam': 'Delete my spam emails',
    'chat.suggest.classify': 'Classify my unprocessed emails',
    'chat.suggest.findBoss': 'Find emails from my boss',
    'chat.input.placeholder': 'Ask me anything about your emails...',
    'chat.helper': 'I can help you delete spam, classify emails, search your inbox, and more!',
    // Header
    'greeting.morning': 'Good morning',
    'greeting.afternoon': 'Good afternoon',
    'greeting.evening': 'Good evening',
    'header.sync': 'Sync',
    'header.notifications': 'Notifications',
    'header.notifications.none': 'No notifications yet',
    'header.notifications.clear': 'Clear',
    'header.signedInWithGoogle': 'Signed in with Google',
    'header.signOut': 'Sign out',
    // Emails Page extras
    'emails.selectAll': 'Select All',
    'emails.delete': 'Delete',
    'emails.archive': 'Archive',
    'emails.spam': 'Spam',
    'emails.unprocessed': 'Unprocessed',
    'emails.aiConfidence': 'AI Confidence:',
    // Chat extras
    'chat.suggestions': 'Suggestions:',
    'chat.thinking': 'Thinking...',
    'chat.quick.delete': 'Delete',
    'chat.quick.spamEmails': 'Spam Emails',
    'chat.quick.classify': 'Classify',
    'chat.quick.emails': 'Emails',
    'chat.quick.showStats': 'Show Email Stats',
    'chat.quick.syncLatest': 'Sync Latest Emails',

    // Analytics
    'analytics.title': 'Analytics',
    'analytics.subtitle': 'Insights into your email patterns and management',
    'analytics.refresh': 'Refresh Analytics',
    'analytics.lastUpdated': 'Last updated',
    'analytics.loading': 'Loading analytics data...',
    'analytics.noData': 'No analytics data loaded. Check console for errors.',
    'analytics.emailsReceived': 'Emails Received',
    'analytics.range.7d': 'Last 7 days',
    'analytics.range.30d': 'Last 30 days',
    'analytics.range.90d': 'Last 90 days',
    'analytics.range.1y': 'Last year',
    'analytics.range.lifetime': 'Lifetime',
    'analytics.chart.volume': 'Email Volume Over Time',
    'analytics.chart.categories': 'Email Categories',
    'analytics.tooltip.emails': 'Emails',
    'analytics.tooltip.spam': 'Spam',
    'analytics.processing': 'Processing Status',
    'analytics.processed': 'Processed',
    'analytics.unprocessed': 'Unprocessed',
    'analytics.spamDetected': 'Spam Detected',
    'analytics.vsLastPeriod': 'vs last period',
    'analytics.timeInsights': 'Time Insights',
    'analytics.peakHour': 'Peak Email Hour',
    'analytics.busiestDay': 'Busiest Day',
    'analytics.weekendEmails': 'Weekend Emails',
    'analytics.cleanup': 'Cleanup Efficiency',
    'analytics.labelCoverage': 'Label Coverage',
    'analytics.processedRate': 'Processed Rate',
    'analytics.timeSaved': 'Estimated Time Saved',
    // Days
    'day.sunday': 'Sunday',
    'day.monday': 'Monday',
    'day.tuesday': 'Tuesday',
    'day.wednesday': 'Wednesday',
    'day.thursday': 'Thursday',
    'day.friday': 'Friday',
    'day.saturday': 'Saturday',

    // Settings
    'settings.title': 'Settings',
    'settings.subtitle': 'Manage your account and application preferences',
    'settings.accountInfo': 'Account Information',
    'settings.firstName': 'First Name',
    'settings.lastName': 'Last Name',
    'settings.emailAddress': 'Email Address',
    'settings.accountId': 'Account ID',
    'settings.privacy': 'Privacy & Security',
    'settings.dataRetention': 'Data Retention Period',
    'settings.shareAnalytics': 'Share Anonymous Analytics',
    'settings.emailPreview': 'Email Content Preview',
    'settings.appPrefs': 'Application Preferences',
    'settings.theme': 'Theme',
    'settings.language': 'Language',
    'settings.timezone': 'Timezone',
    'settings.emailsPerPage': 'Emails per page',
    'settings.save': 'Save Settings',
    'settings.theme.light': 'Light',
    'settings.theme.dark': 'Dark',
    'settings.theme.auto': 'Auto (System)',
    'settings.timezone.auto': 'Auto-detect',
    'settings.timezone.utc': 'UTC',
    'settings.timezone.est': 'US/Eastern',
    'settings.timezone.pst': 'US/Pacific',
    'settings.quickActions': 'Quick Actions',
    'settings.signOut': 'Sign Out',
    'settings.danger': 'Danger Zone',
    'settings.deleteAccount': 'Delete Account',
    'settings.support': 'Support',
    'settings.privacyPolicy': 'Privacy Policy',
    'settings.terms': 'Terms of Service',
    'settings.memberSince': 'Member since',
    'settings.retention.3months': '3 months',
    'settings.retention.6months': '6 months',
    'settings.retention.1year': '1 year',
    'settings.retention.2years': '2 years',
    'settings.retention.forever': 'Keep forever',
    'settings.shareAnalytics.help': 'Help improve ScrapIt by sharing usage data',
    'settings.emailPreview.help': 'Show email snippets in the interface',
  },
  es: {
    'nav.dashboard': 'Panel',
    'nav.emails': 'Correos',
    'nav.chat': 'Asistente IA',
    'nav.analytics': 'Analítica',
    'nav.settings': 'Ajustes',
    'app.tagline': 'Limpiador de correo',

    'dashboard.title': 'Panel',
    'dashboard.subtitle': 'Resumen de la gestión de tu correo',
    'dashboard.stats.total': 'Correos totales',
    'dashboard.stats.spam': 'Correos spam',
    'dashboard.stats.unprocessed': 'Sin procesar',
    'dashboard.stats.categories': 'Categorías',
    'dashboard.quickActions': 'Acciones rápidas',
    'dashboard.topSenders': 'Remitentes principales',
    'dashboard.emailCategories': 'Categorías de correo',
    'dashboard.noActions': 'No hay acciones disponibles',
    'dashboard.noActionsHint': 'Sincroniza tus correos para ver acciones',

    'emails.title': 'Correos',
    'emails.filters': 'Filtros',
    'emails.search.placeholder': 'Busca por asunto, remitente o contenido...',
    'emails.category': 'Categoría',
    'emails.label': 'Etiqueta',
    'emails.sender': 'Remitente',
    'emails.spamFilter': 'Filtro de spam',
    'emails.allCategories': 'Todas las categorías',
    'emails.allLabels': 'Todas las etiquetas',
    'emails.allSenders': 'Todos los remitentes',
    'emails.allEmails': 'Todos los correos',
    'emails.notSpam': 'Sin spam',
    'emails.spamOnly': 'Solo spam',
    'emails.clearFilters': 'Borrar filtros',
    'emails.noEmails': 'No se encontraron correos',
    'emails.tryAdjust': 'Prueba a ajustar tu búsqueda o filtros',
    'emails.syncToSee': 'Sincroniza tus correos para verlos aquí',
    'emails.previous': 'Anterior',
    'emails.next': 'Siguiente',
    'emails.matchingLabel': 'coinciden',
    'emails.page': 'página',
    'emails.of': 'de',

    'chat.title': 'Asistente IA',
    'chat.subtitle': 'Chatea con tu asistente de correo',
    'chat.aiPowered': 'Con IA',
    'chat.quickActions': 'Acciones rápidas',
    'chat.welcome': '¡Hola! Soy tu asistente de ScrapIt. Puedo ayudarte a gestionar tus correos con lenguaje natural.',
    'chat.suggest.showStats': 'Muéstrame mis estadísticas de correo',
    'chat.suggest.deleteSpam': 'Elimina mis correos spam',
    'chat.suggest.classify': 'Clasifica mis correos sin procesar',
    'chat.suggest.findBoss': 'Encuentra correos de mi jefe',
    'chat.input.placeholder': 'Pregunta lo que quieras sobre tus correos...',
    'chat.helper': 'Puedo ayudarte a eliminar spam, clasificar correos, buscar en tu bandeja y más.',
    // Header
    'greeting.morning': 'Buenos días',
    'greeting.afternoon': 'Buenas tardes',
    'greeting.evening': 'Buenas noches',
    'header.sync': 'Sincronizar',
    'header.notifications': 'Notificaciones',
    'header.notifications.none': 'Aún no hay notificaciones',
    'header.notifications.clear': 'Borrar',
    'header.signedInWithGoogle': 'Conectado con Google',
    'header.signOut': 'Cerrar sesión',
    // Emails Page extras
    'emails.selectAll': 'Seleccionar todo',
    'emails.delete': 'Eliminar',
    'emails.archive': 'Archivar',
    'emails.spam': 'Spam',
    'emails.unprocessed': 'Sin procesar',
    'emails.aiConfidence': 'Confianza IA:',
    // Chat extras
    'chat.suggestions': 'Sugerencias:',
    'chat.thinking': 'Pensando...',
    'chat.quick.delete': 'Eliminar',
    'chat.quick.spamEmails': 'correos spam',
    'chat.quick.classify': 'Clasificar',
    'chat.quick.emails': 'correos',
    'chat.quick.showStats': 'Mostrar estadísticas de correo',
    'chat.quick.syncLatest': 'Sincronizar correos recientes',

    'analytics.title': 'Analítica',
    'analytics.subtitle': 'Información sobre tus patrones de correo',
    'analytics.refresh': 'Actualizar analítica',
    'analytics.lastUpdated': 'Última actualización',
    'analytics.loading': 'Cargando datos de analítica...',
    'analytics.noData': 'No se cargaron datos de analítica. Revisa la consola para errores.',
    'analytics.emailsReceived': 'Correos recibidos',
    'analytics.range.7d': 'Últimos 7 días',
    'analytics.range.30d': 'Últimos 30 días',
    'analytics.range.90d': 'Últimos 90 días',
    'analytics.range.1y': 'Último año',
    'analytics.range.lifetime': 'Toda la vida',
    'analytics.chart.volume': 'Volumen de correos en el tiempo',
    'analytics.chart.categories': 'Categorías de correo',
    'analytics.tooltip.emails': 'Correos',
    'analytics.tooltip.spam': 'Spam',
    'analytics.processing': 'Estado de procesamiento',
    'analytics.processed': 'Procesados',
    'analytics.unprocessed': 'Sin procesar',
    'analytics.spamDetected': 'Spam detectado',
    'analytics.vsLastPeriod': 'vs periodo anterior',
    'analytics.timeInsights': 'Información temporal',
    'analytics.peakHour': 'Hora pico',
    'analytics.busiestDay': 'Día más activo',
    'analytics.weekendEmails': 'Correos en fin de semana',
    'analytics.cleanup': 'Eficiencia de limpieza',
    'analytics.labelCoverage': 'Cobertura de etiquetas',
    'analytics.processedRate': 'Tasa procesado',
    'analytics.timeSaved': 'Tiempo estimado ahorrado',
    // Days
    'day.sunday': 'Domingo',
    'day.monday': 'Lunes',
    'day.tuesday': 'Martes',
    'day.wednesday': 'Miércoles',
    'day.thursday': 'Jueves',
    'day.friday': 'Viernes',
    'day.saturday': 'Sábado',

    'settings.title': 'Ajustes',
    'settings.subtitle': 'Gestiona tu cuenta y preferencias',
    'settings.accountInfo': 'Información de la cuenta',
    'settings.firstName': 'Nombre',
    'settings.lastName': 'Apellido',
    'settings.emailAddress': 'Correo electrónico',
    'settings.accountId': 'ID de cuenta',
    'settings.privacy': 'Privacidad y seguridad',
    'settings.dataRetention': 'Periodo de retención de datos',
    'settings.shareAnalytics': 'Compartir analíticas anónimas',
    'settings.emailPreview': 'Vista previa de contenido de correo',
    'settings.appPrefs': 'Preferencias de la aplicación',
    'settings.theme': 'Tema',
    'settings.language': 'Idioma',
    'settings.timezone': 'Zona horaria',
    'settings.emailsPerPage': 'Correos por página',
    'settings.save': 'Guardar ajustes',
    'settings.theme.light': 'Claro',
    'settings.theme.dark': 'Oscuro',
    'settings.theme.auto': 'Automático (Sistema)',
    'settings.timezone.auto': 'Detección automática',
    'settings.timezone.utc': 'UTC',
    'settings.timezone.est': 'EE.UU./Este',
    'settings.timezone.pst': 'EE.UU./Pacífico',
    'settings.quickActions': 'Acciones rápidas',
    'settings.signOut': 'Cerrar sesión',
    'settings.danger': 'Zona de peligro',
    'settings.deleteAccount': 'Eliminar cuenta',
    'settings.support': 'Soporte',
    'settings.privacyPolicy': 'Política de privacidad',
    'settings.terms': 'Términos del servicio',
    'settings.memberSince': 'Miembro desde',
    'settings.retention.3months': '3 meses',
    'settings.retention.6months': '6 meses',
    'settings.retention.1year': '1 año',
    'settings.retention.2years': '2 años',
    'settings.retention.forever': 'Conservar para siempre',
    'settings.shareAnalytics.help': 'Ayuda a mejorar ScrapIt compartiendo datos de uso',
    'settings.emailPreview.help': 'Mostrar fragmentos de correo en la interfaz',
  },
  fr: {
    'dashboard.topSenders': 'Principaux expéditeurs',
    'dashboard.emailCategories': 'Catégories d’email',
    'emails.matchingLabel': 'correspondants',
    'emails.page': 'page',
    'emails.of': 'sur',
    'nav.dashboard': 'Tableau de bord',
    'nav.emails': 'Emails',
    'nav.chat': 'Assistant IA',
    'nav.analytics': 'Analytique',
    'nav.settings': 'Paramètres',
    'app.tagline': 'Nettoyeur d’email',

    'dashboard.title': 'Tableau de bord',
    'dashboard.subtitle': 'Aperçu de la gestion de vos emails',
    'dashboard.stats.total': 'Emails totaux',
    'dashboard.stats.spam': 'Emails indésirables',
    'dashboard.stats.unprocessed': 'Non traités',
    'dashboard.stats.categories': 'Catégories',
    'dashboard.quickActions': 'Actions rapides',
    'dashboard.noActions': 'Aucune action disponible',
    'dashboard.noActionsHint': 'Synchronisez vos emails pour voir des actions',

    'emails.title': 'Emails',
    'emails.filters': 'Filtres',
    'emails.search.placeholder': 'Rechercher par objet, expéditeur ou contenu...',
    'emails.category': 'Catégorie',
    'emails.label': 'Libellé',
    'emails.sender': 'Expéditeur',
    'emails.spamFilter': 'Filtre spam',
    'emails.allCategories': 'Toutes les catégories',
    'emails.allLabels': 'Tous les libellés',
    'emails.allSenders': 'Tous les expéditeurs',
    'emails.allEmails': 'Tous les emails',
    'emails.notSpam': 'Sans spam',
    'emails.spamOnly': 'Spam uniquement',
    'emails.clearFilters': 'Effacer les filtres',
    'emails.noEmails': 'Aucun email trouvé',
    'emails.tryAdjust': 'Essayez d’ajuster votre recherche ou vos filtres',
    'emails.syncToSee': 'Synchronisez vos emails pour les voir ici',
    'emails.previous': 'Précédent',
    'emails.next': 'Suivant',

    'chat.title': 'Assistant IA',
    'chat.subtitle': 'Discutez avec votre assistant de messagerie',
    'chat.aiPowered': 'Propulsé par IA',
    'chat.quickActions': 'Actions rapides',
    'chat.welcome': "Bonjour ! Je suis votre assistant ScrapIt. Je peux vous aider à gérer vos emails.",
    'chat.suggest.showStats': 'Afficher mes statistiques d’email',
    'chat.suggest.deleteSpam': 'Supprimer mes spams',
    'chat.suggest.classify': 'Classer mes emails non traités',
    'chat.suggest.findBoss': 'Trouver les emails de mon patron',
    'chat.input.placeholder': 'Demandez-moi n’importe quoi sur vos emails…',
    'chat.helper': 'Je peux supprimer le spam, classer, rechercher et plus encore.',
    // Header
    'greeting.morning': 'Bonjour',
    'greeting.afternoon': 'Bon après-midi',
    'greeting.evening': 'Bonsoir',
    'header.sync': 'Synchroniser',
    'header.notifications': 'Notifications',
    'header.notifications.none': 'Pas encore de notifications',
    'header.notifications.clear': 'Effacer',
    'header.signedInWithGoogle': 'Connecté avec Google',
    'header.signOut': 'Se déconnecter',
    // Emails Page extras
    'emails.selectAll': 'Tout sélectionner',
    'emails.delete': 'Supprimer',
    'emails.archive': 'Archiver',
    'emails.spam': 'Spam',
    'emails.unprocessed': 'Non traité',
    'emails.aiConfidence': 'Confiance IA :',
    // Chat extras
    'chat.suggestions': 'Suggestions :',
    'chat.thinking': 'Réflexion...',
    'chat.quick.delete': 'Supprimer',
    'chat.quick.spamEmails': 'emails indésirables',
    'chat.quick.classify': 'Classer',
    'chat.quick.emails': 'emails',
    'chat.quick.showStats': 'Afficher les statistiques',
    'chat.quick.syncLatest': 'Synchroniser les derniers emails',

    'analytics.title': 'Analytique',
    'analytics.subtitle': 'Aperçus de vos habitudes d’email',
    'analytics.refresh': 'Actualiser',
    'analytics.lastUpdated': 'Dernière mise à jour',
    'analytics.loading': 'Chargement des données analytiques…',
    'analytics.noData': 'Aucune donnée analytique chargée. Voir la console pour les erreurs.',
    'analytics.emailsReceived': 'Emails reçus',
    'analytics.range.7d': '7 derniers jours',
    'analytics.range.30d': '30 derniers jours',
    'analytics.range.90d': '90 derniers jours',
    'analytics.range.1y': 'Dernière année',
    'analytics.range.lifetime': 'Durée de vie',
    'analytics.chart.volume': 'Volume de mails dans le temps',
    'analytics.chart.categories': 'Catégories d’emails',
    'analytics.tooltip.emails': 'Emails',
    'analytics.tooltip.spam': 'Spam',
    'analytics.processing': 'Statut de traitement',
    'analytics.processed': 'Traités',
    'analytics.unprocessed': 'Non traités',
    'analytics.spamDetected': 'Spam détecté',
    'analytics.vsLastPeriod': 'vs période précédente',
    'analytics.timeInsights': 'Aperçus temporels',
    'analytics.peakHour': 'Heure de pointe',
    'analytics.busiestDay': 'Jour le plus chargé',
    'analytics.weekendEmails': 'Emails le weekend',
    'analytics.cleanup': 'Efficacité du nettoyage',
    'analytics.labelCoverage': 'Couverture des libellés',
    'analytics.processedRate': 'Taux traité',
    'analytics.timeSaved': 'Temps estimé gagné',
    // Days
    'day.sunday': 'Dimanche',
    'day.monday': 'Lundi',
    'day.tuesday': 'Mardi',
    'day.wednesday': 'Mercredi',
    'day.thursday': 'Jeudi',
    'day.friday': 'Vendredi',
    'day.saturday': 'Samedi',

    'settings.title': 'Paramètres',
    'settings.subtitle': 'Gérez votre compte et vos préférences',
    'settings.accountInfo': 'Informations du compte',
    'settings.firstName': 'Prénom',
    'settings.lastName': 'Nom',
    'settings.emailAddress': 'Adresse e-mail',
    'settings.accountId': 'ID du compte',
    'settings.privacy': 'Confidentialité et sécurité',
    'settings.dataRetention': 'Durée de conservation des données',
    'settings.shareAnalytics': 'Partager des analyses anonymes',
    'settings.emailPreview': 'Aperçu du contenu des emails',
    'settings.appPrefs': 'Préférences de l’application',
    'settings.theme': 'Thème',
    'settings.language': 'Langue',
    'settings.timezone': 'Fuseau horaire',
    'settings.emailsPerPage': 'Emails par page',
    'settings.save': 'Enregistrer',
    'settings.theme.light': 'Clair',
    'settings.theme.dark': 'Sombre',
    'settings.theme.auto': 'Auto (Système)',
    'settings.timezone.auto': 'Détection automatique',
    'settings.timezone.utc': 'UTC',
    'settings.timezone.est': 'États-Unis/Est',
    'settings.timezone.pst': 'États-Unis/Pacifique',
    'settings.quickActions': 'Actions rapides',
    'settings.signOut': 'Se déconnecter',
    'settings.danger': 'Zone de danger',
    'settings.deleteAccount': 'Supprimer le compte',
    'settings.support': 'Support',
    'settings.privacyPolicy': 'Politique de confidentialité',
    'settings.terms': 'Conditions d’utilisation',
    'settings.memberSince': 'Membre depuis',
    'settings.retention.3months': '3 mois',
    'settings.retention.6months': '6 mois',
    'settings.retention.1year': '1 an',
    'settings.retention.2years': '2 ans',
    'settings.retention.forever': 'Conserver pour toujours',
    'settings.shareAnalytics.help': 'Aider à améliorer ScrapIt en partageant des données d’utilisation',
    'settings.emailPreview.help': 'Afficher des extraits d’e-mails dans l’interface',
  },
  de: {
    'dashboard.topSenders': 'Top-Absender',
    'dashboard.emailCategories': 'E-Mail-Kategorien',
    'emails.matchingLabel': 'Treffer',
    'emails.page': 'Seite',
    'emails.of': 'von',
    'nav.dashboard': 'Übersicht',
    'nav.emails': 'E-Mails',
    'nav.chat': 'KI-Assistent',
    'nav.analytics': 'Analytik',
    'nav.settings': 'Einstellungen',
    'app.tagline': 'E-Mail-Reiniger',

    'dashboard.title': 'Übersicht',
    'dashboard.subtitle': 'Überblick über Ihr E-Mail-Management',
    'dashboard.stats.total': 'Gesamt-E-Mails',
    'dashboard.stats.spam': 'Spam-E-Mails',
    'dashboard.stats.unprocessed': 'Unbearbeitet',
    'dashboard.stats.categories': 'Kategorien',
    'dashboard.quickActions': 'Schnellaktionen',
    'dashboard.noActions': 'Keine Aktionen verfügbar',
    'dashboard.noActionsHint': 'Synchronisieren Sie E-Mails, um Aktionen zu sehen',

    'emails.title': 'E-Mails',
    'emails.filters': 'Filter',
    'emails.search.placeholder': 'Suche nach Betreff, Absender oder Inhalt...',
    'emails.category': 'Kategorie',
    'emails.label': 'Label',
    'emails.sender': 'Absender',
    'emails.spamFilter': 'Spam-Filter',
    'emails.allCategories': 'Alle Kategorien',
    'emails.allLabels': 'Alle Labels',
    'emails.allSenders': 'Alle Absender',
    'emails.allEmails': 'Alle E-Mails',
    'emails.notSpam': 'Kein Spam',
    'emails.spamOnly': 'Nur Spam',
    'emails.clearFilters': 'Filter löschen',
    'emails.noEmails': 'Keine E-Mails gefunden',
    'emails.tryAdjust': 'Passen Sie Ihre Suche oder Filter an',
    'emails.syncToSee': 'Synchronisieren Sie Ihre E-Mails, um sie hier zu sehen',
    'emails.previous': 'Zurück',
    'emails.next': 'Weiter',

    'chat.title': 'KI-Assistent',
    'chat.subtitle': 'Chatten Sie mit Ihrem E-Mail-Assistenten',
    'chat.aiPowered': 'KI-gestützt',
    'chat.quickActions': 'Schnellaktionen',
    'chat.welcome': 'Hallo! Ich bin Ihr ScrapIt-Assistent. Ich helfe beim E-Mail-Management.',
    'chat.suggest.showStats': 'Zeige mir meine E-Mail-Statistiken',
    'chat.suggest.deleteSpam': 'Lösche meine Spam-E-Mails',
    'chat.suggest.classify': 'Klassifiziere meine unbearbeiteten E-Mails',
    'chat.suggest.findBoss': 'Finde E-Mails meines Chefs',
    'chat.input.placeholder': 'Fragen Sie mich alles zu Ihren E-Mails…',
    'chat.helper': 'Ich kann Spam löschen, klassifizieren, suchen und mehr.',
    // Header
    'greeting.morning': 'Guten Morgen',
    'greeting.afternoon': 'Guten Tag',
    'greeting.evening': 'Guten Abend',
    'header.sync': 'Synchronisieren',
    'header.notifications': 'Benachrichtigungen',
    'header.notifications.none': 'Noch keine Benachrichtigungen',
    'header.notifications.clear': 'Löschen',
    'header.signedInWithGoogle': 'Mit Google angemeldet',
    'header.signOut': 'Abmelden',
    // Emails Page extras
    'emails.selectAll': 'Alle auswählen',
    'emails.delete': 'Löschen',
    'emails.archive': 'Archivieren',
    'emails.spam': 'Spam',
    'emails.unprocessed': 'Unbearbeitet',
    'emails.aiConfidence': 'KI-Vertrauen:',
    // Chat extras
    'chat.suggestions': 'Vorschläge:',
    'chat.thinking': 'Denke nach...',
    'chat.quick.delete': 'Löschen',
    'chat.quick.spamEmails': 'Spam-E-Mails',
    'chat.quick.classify': 'Klassifizieren',
    'chat.quick.emails': 'E-Mails',
    'chat.quick.showStats': 'E-Mail-Statistiken anzeigen',
    'chat.quick.syncLatest': 'Neueste E-Mails synchronisieren',

    'analytics.title': 'Analytik',
    'analytics.subtitle': 'Einblicke in Ihr E-Mail-Verhalten',
    'analytics.refresh': 'Analytik aktualisieren',
    'analytics.lastUpdated': 'Zuletzt aktualisiert',
    'analytics.loading': 'Analysedaten werden geladen…',
    'analytics.noData': 'Keine Analysedaten geladen. Siehe Konsole für Fehler.',
    'analytics.emailsReceived': 'Empfangene E-Mails',
    'analytics.range.7d': 'Letzte 7 Tage',
    'analytics.range.30d': 'Letzte 30 Tage',
    'analytics.range.90d': 'Letzte 90 Tage',
    'analytics.range.1y': 'Letztes Jahr',
    'analytics.range.lifetime': 'Gesamte Zeit',
    'analytics.chart.volume': 'E-Mail-Volumen über Zeit',
    'analytics.chart.categories': 'E-Mail-Kategorien',
    'analytics.tooltip.emails': 'E-Mails',
    'analytics.tooltip.spam': 'Spam',
    'analytics.processing': 'Verarbeitungsstatus',
    'analytics.processed': 'Verarbeitet',
    'analytics.unprocessed': 'Unbearbeitet',
    'analytics.spamDetected': 'Spam erkannt',
    'analytics.vsLastPeriod': 'ggü. letzter Periode',
    'analytics.timeInsights': 'Zeiteinblicke',
    'analytics.peakHour': 'Stoßzeit',
    'analytics.busiestDay': 'Stärkster Tag',
    'analytics.weekendEmails': 'E-Mails am Wochenende',
    'analytics.cleanup': 'Aufräum-Effizienz',
    'analytics.labelCoverage': 'Label-Abdeckung',
    'analytics.processedRate': 'Verarbeitungsrate',
    'analytics.timeSaved': 'Ersparte Zeit',
    // Days
    'day.sunday': 'Sonntag',
    'day.monday': 'Montag',
    'day.tuesday': 'Dienstag',
    'day.wednesday': 'Mittwoch',
    'day.thursday': 'Donnerstag',
    'day.friday': 'Freitag',
    'day.saturday': 'Samstag',

    'settings.title': 'Einstellungen',
    'settings.subtitle': 'Konto und Präferenzen verwalten',
    'settings.accountInfo': 'Kontoinformationen',
    'settings.firstName': 'Vorname',
    'settings.lastName': 'Nachname',
    'settings.emailAddress': 'E-Mail-Adresse',
    'settings.accountId': 'Konto-ID',
    'settings.privacy': 'Datenschutz und Sicherheit',
    'settings.dataRetention': 'Aufbewahrungszeitraum',
    'settings.shareAnalytics': 'Anonyme Analysen teilen',
    'settings.emailPreview': 'E-Mail-Inhaltsvorschau',
    'settings.appPrefs': 'App-Einstellungen',
    'settings.theme': 'Thema',
    'settings.language': 'Sprache',
    'settings.timezone': 'Zeitzone',
    'settings.emailsPerPage': 'E-Mails pro Seite',
    'settings.save': 'Einstellungen speichern',
    'settings.theme.light': 'Hell',
    'settings.theme.dark': 'Dunkel',
    'settings.theme.auto': 'Auto (System)',
    'settings.timezone.auto': 'Automatisch erkennen',
    'settings.timezone.utc': 'UTC',
    'settings.timezone.est': 'USA/Ost',
    'settings.timezone.pst': 'USA/Pazifik',
    'settings.quickActions': 'Schnellaktionen',
    'settings.signOut': 'Abmelden',
    'settings.danger': 'Gefahrenzone',
    'settings.deleteAccount': 'Konto löschen',
    'settings.support': 'Support',
    'settings.privacyPolicy': 'Datenschutzrichtlinie',
    'settings.terms': 'Nutzungsbedingungen',
    'settings.memberSince': 'Mitglied seit',
    'settings.retention.3months': '3 Monate',
    'settings.retention.6months': '6 Monate',
    'settings.retention.1year': '1 Jahr',
    'settings.retention.2years': '2 Jahre',
    'settings.retention.forever': 'Für immer behalten',
    'settings.shareAnalytics.help': 'Hilf, ScrapIt zu verbessern, indem du Nutzungsdaten teilst',
    'settings.emailPreview.help': 'E-Mail-Ausschnitte in der Oberfläche anzeigen',
  }
  ,
  ar: {
    'nav.dashboard': 'لوحة التحكم',
    'nav.emails': 'البريد',
    'nav.chat': 'المساعد الذكي',
    'nav.analytics': 'التحليلات',
    'nav.settings': 'الإعدادات',
    'app.tagline': 'منظف البريد',
    'dashboard.title': 'لوحة التحكم',
    'dashboard.subtitle': 'نظرة عامة على إدارة بريدك',
    'dashboard.stats.total': 'إجمالي الرسائل',
    'dashboard.stats.spam': 'رسائل مزعجة',
    'dashboard.stats.unprocessed': 'غير معالج',
    'dashboard.stats.categories': 'الفئات',
    'dashboard.quickActions': 'إجراءات سريعة',
    'dashboard.topSenders': 'أهم المرسلين',
    'dashboard.emailCategories': 'فئات البريد',
    'emails.title': 'البريد',
    'emails.filters': 'عوامل التصفية',
    'emails.search.placeholder': 'ابحث حسب الموضوع أو المرسل أو المحتوى...',
    'emails.category': 'الفئة',
    'emails.label': 'العلامة',
    'emails.sender': 'المرسل',
    'emails.spamFilter': 'عامل تصفية الرسائل المزعجة',
    'emails.allCategories': 'كل الفئات',
    'emails.allLabels': 'كل العلامات',
    'emails.allSenders': 'كل المرسلين',
    'emails.allEmails': 'كل الرسائل',
    'emails.notSpam': 'غير مزعج',
    'emails.spamOnly': 'مزعج فقط',
    'emails.clearFilters': 'مسح المرشحات',
    'emails.noEmails': 'لا توجد رسائل',
    'emails.previous': 'السابق',
    'emails.next': 'التالي',
    'emails.matchingLabel': 'مطابقة',
    'emails.page': 'صفحة',
    'emails.of': 'من',
    'chat.title': 'المساعد الذكي',
    'chat.subtitle': 'تحدث مع مساعد إدارة البريد',
    'chat.aiPowered': 'مدعوم بالذكاء الاصطناعي',
    'chat.quickActions': 'إجراءات سريعة',
    'chat.welcome': 'مرحبًا! أنا مساعدك في ScrapIt. أساعدك على إدارة بريدك.',
    'chat.suggest.showStats': 'أرني إحصائيات بريدي',
    'chat.suggest.deleteSpam': 'احذف الرسائل المزعجة',
    'chat.suggest.classify': 'صنّف رسائلي غير المعالجة',
    'chat.suggest.findBoss': 'ابحث عن رسائل من مديري',
    'chat.input.placeholder': 'اسألني أي شيء عن بريدك...',
    'chat.helper': 'أستطيع حذف المزعج، التصنيف، البحث والمزيد.',
    'chat.suggestions': 'اقتراحات:',
    'chat.thinking': 'جارٍ التفكير...',
    'chat.quick.delete': 'حذف',
    'chat.quick.spamEmails': 'رسائل مزعجة',
    'chat.quick.classify': 'تصنيف',
    'chat.quick.emails': 'رسائل',
    'chat.quick.showStats': 'عرض إحصائيات البريد',
    'chat.quick.syncLatest': 'مزامنة أحدث الرسائل',
    'analytics.title': 'التحليلات',
    'analytics.subtitle': 'رؤى حول أنماط بريدك',
    'analytics.refresh': 'تحديث التحليلات',
    'analytics.lastUpdated': 'آخر تحديث',
    'analytics.loading': 'جاري تحميل بيانات التحليلات...',
    'analytics.noData': 'لا توجد بيانات تحليلات.',
    'analytics.emailsReceived': 'الرسائل المستلمة',
    'analytics.range.7d': 'آخر 7 أيام',
    'analytics.range.30d': 'آخر 30 يومًا',
    'analytics.range.90d': 'آخر 90 يومًا',
    'analytics.range.1y': 'آخر سنة',
    'analytics.range.lifetime': 'مدى الحياة',
    'analytics.chart.volume': 'حجم البريد عبر الزمن',
    'analytics.chart.categories': 'فئات البريد',
    'analytics.tooltip.emails': 'رسائل',
    'analytics.tooltip.spam': 'مزعج',
    'analytics.processing': 'حالة المعالجة',
    'analytics.processed': 'معالج',
    'analytics.unprocessed': 'غير معالج',
    'analytics.spamDetected': 'تم اكتشاف المزعج',
    'analytics.vsLastPeriod': 'مقارنة بالفترة السابقة',
    'analytics.timeInsights': 'رؤى زمنية',
    'analytics.peakHour': 'ساعة الذروة',
    'analytics.busiestDay': 'أكثر الأيام ازدحامًا',
    'analytics.weekendEmails': 'رسائل عطلة نهاية الأسبوع',
    'analytics.cleanup': 'كفاءة التنظيف',
    'analytics.labelCoverage': 'تغطية العلامات',
    'analytics.processedRate': 'معدل المعالجة',
    'analytics.timeSaved': 'الوقت الموفّر',
    // Days
    'day.sunday': 'الأحد',
    'day.monday': 'الإثنين',
    'day.tuesday': 'الثلاثاء',
    'day.wednesday': 'الأربعاء',
    'day.thursday': 'الخميس',
    'day.friday': 'الجمعة',
    'day.saturday': 'السبت',
    // Settings
    'settings.title': 'الإعدادات',
    'settings.subtitle': 'إدارة حسابك وتفضيلات التطبيق',
    'settings.accountInfo': 'معلومات الحساب',
    'settings.firstName': 'الاسم الأول',
    'settings.lastName': 'اسم العائلة',
    'settings.emailAddress': 'البريد الإلكتروني',
    'settings.accountId': 'معرّف الحساب',
    'settings.privacy': 'الخصوصية والأمان',
    'settings.dataRetention': 'فترة الاحتفاظ بالبيانات',
    'settings.shareAnalytics': 'مشاركة التحليلات المجهولة',
    'settings.emailPreview': 'معاينة محتوى البريد',
    'settings.appPrefs': 'تفضيلات التطبيق',
    'settings.theme': 'السمة',
    'settings.language': 'اللغة',
    'settings.timezone': 'المنطقة الزمنية',
    'settings.emailsPerPage': 'رسائل لكل صفحة',
    'settings.save': 'حفظ الإعدادات',
    'settings.theme.light': 'فاتح',
    'settings.theme.dark': 'داكن',
    'settings.theme.auto': 'تلقائي (النظام)',
    'settings.timezone.auto': 'الكشف التلقائي',
    'settings.timezone.utc': 'UTC',
    'settings.timezone.est': 'الولايات المتحدة/الشرقية',
    'settings.timezone.pst': 'الولايات المتحدة/المحيط الهادئ',
    'settings.quickActions': 'إجراءات سريعة',
    'settings.signOut': 'تسجيل الخروج',
    'settings.danger': 'منطقة الخطر',
    'settings.deleteAccount': 'حذف الحساب',
    'settings.support': 'الدعم',
    'settings.privacyPolicy': 'سياسة الخصوصية',
    'settings.terms': 'شروط الخدمة',
    'settings.memberSince': 'عضو منذ',
    'settings.retention.3months': '3 أشهر',
    'settings.retention.6months': '6 أشهر',
    'settings.retention.1year': 'سنة واحدة',
    'settings.retention.2years': 'سنتان',
    'settings.retention.forever': 'احتفظ بها دائمًا',
    'settings.shareAnalytics.help': 'ساعد في تحسين ScrapIt بمشاركة بيانات الاستخدام',
    'settings.emailPreview.help': 'عرض مقتطفات البريد في الواجهة',
  },
  hi: {
    'nav.dashboard': 'डैशबोर्ड',
    'nav.emails': 'ईमेल',
    'nav.chat': 'एआई सहायक',
    'nav.analytics': 'एनालिटिक्स',
    'nav.settings': 'सेटिंग्स',
    'app.tagline': 'ईमेल क्लीनर',
    'dashboard.title': 'डैशबोर्ड',
    'dashboard.subtitle': 'आपके ईमेल प्रबंधन का अवलोकन',
    'dashboard.stats.total': 'कुल ईमेल',
    'dashboard.stats.spam': 'स्पैम ईमेल',
    'dashboard.stats.unprocessed': 'अप्रसंस्कृत',
    'dashboard.stats.categories': 'श्रेणियाँ',
    'dashboard.quickActions': 'त्वरित क्रियाएँ',
    'dashboard.topSenders': 'शीर्ष प्रेषक',
    'dashboard.emailCategories': 'ईमेल श्रेणियाँ',
    'emails.title': 'ईमेल',
    'emails.filters': 'फ़िल्टर',
    'emails.search.placeholder': 'विषय, प्रेषक या सामग्री से खोजें...',
    'emails.category': 'श्रेणी',
    'emails.label': 'लेबल',
    'emails.sender': 'प्रेषक',
    'emails.spamFilter': 'स्पैम फ़िल्टर',
    'emails.allCategories': 'सभी श्रेणियाँ',
    'emails.allLabels': 'सभी लेबल',
    'emails.allSenders': 'सभी प्रेषक',
    'emails.allEmails': 'सभी ईमेल',
    'emails.notSpam': 'स्पैम नहीं',
    'emails.spamOnly': 'केवल स्पैम',
    'emails.clearFilters': 'फ़िल्टर साफ़ करें',
    'emails.noEmails': 'कोई ईमेल नहीं मिला',
    'emails.previous': 'पिछला',
    'emails.next': 'अगला',
    'emails.matchingLabel': 'मिलान',
    'emails.page': 'पृष्ठ',
    'emails.of': 'में से',
    'chat.title': 'एआई सहायक',
    'chat.subtitle': 'अपने ईमेल सहायक से चैट करें',
    'chat.aiPowered': 'एआई द्वारा संचालित',
    'chat.quickActions': 'त्वरित क्रियाएँ',
    'chat.welcome': 'नमस्ते! मैं आपका ScrapIt सहायक हूँ।',
    'chat.suggest.showStats': 'मेरे ईमेल आँकड़े दिखाएँ',
    'chat.suggest.deleteSpam': 'मेरा स्पैम हटाएँ',
    'chat.suggest.classify': 'अप्रसंस्कृत ईमेल वर्गीकृत करें',
    'chat.suggest.findBoss': 'मेरे बॉस के ईमेल खोजें',
    'chat.input.placeholder': 'अपने ईमेल के बारे में कुछ भी पूछें...',
    'chat.helper': 'मैं स्पैम हटाने, वर्गीकरण, खोज और अधिक में मदद कर सकता हूँ।',
    'chat.suggestions': 'सुझाव:',
    'chat.thinking': 'सोच रहा है...',
    'chat.quick.delete': 'हटाएँ',
    'chat.quick.spamEmails': 'स्पैम ईमेल',
    'chat.quick.classify': 'वर्गीकृत करें',
    'chat.quick.emails': 'ईमेल',
    'chat.quick.showStats': 'ईमेल आँकड़े दिखाएँ',
    'chat.quick.syncLatest': 'नवीनतम ईमेल सिंक करें',
    'analytics.title': 'एनालिटिक्स',
    'analytics.subtitle': 'आपके ईमेल पैटर्न पर अंतर्दृष्टि',
    'analytics.refresh': 'एनालिटिक्स ताज़ा करें',
    'analytics.lastUpdated': 'अंतिम अपडेट',
    'analytics.loading': 'एनालिटिक्स डेटा लोड हो रहा है...',
    'analytics.noData': 'कोई एनालिटिक्स डेटा नहीं।',
    'analytics.emailsReceived': 'प्राप्त ईमेल',
    'analytics.range.7d': 'पिछले 7 दिन',
    'analytics.range.30d': 'पिछले 30 दिन',
    'analytics.range.90d': 'पिछले 90 दिन',
    'analytics.range.1y': 'पिछला वर्ष',
    'analytics.range.lifetime': 'आजीवन',
    'analytics.chart.volume': 'समय के साथ ईमेल मात्रा',
    'analytics.chart.categories': 'ईमेल श्रेणियाँ',
    'analytics.tooltip.emails': 'ईमेल',
    'analytics.tooltip.spam': 'स्पैम',
    'analytics.processing': 'प्रसंस्करण स्थिति',
    'analytics.processed': 'प्रसंस्कृत',
    'analytics.unprocessed': 'अप्रसंस्कृत',
    'analytics.spamDetected': 'स्पैम मिला',
    'analytics.vsLastPeriod': 'पिछली अवधि के मुकाबले',
    'analytics.timeInsights': 'समय अंतर्दृष्टि',
    'analytics.peakHour': 'पीक घंटा',
    'analytics.busiestDay': 'सबसे व्यस्त दिन',
    'analytics.weekendEmails': 'सप्ताहांत ईमेल',
    'analytics.cleanup': 'साफ़-सफ़ाई दक्षता',
    'analytics.labelCoverage': 'लेबल कवरेज',
    'analytics.processedRate': 'प्रसंस्करण दर',
    'analytics.timeSaved': 'बचाया समय',
    // Days
    'day.sunday': 'रविवार',
    'day.monday': 'सोमवार',
    'day.tuesday': 'मंगलवार',
    'day.wednesday': 'बुधवार',
    'day.thursday': 'गुरुवार',
    'day.friday': 'शुक्रवार',
    'day.saturday': 'शनिवार',
    // Settings
    'settings.title': 'सेटिंग्स',
    'settings.subtitle': 'अपने खाते और ऐप प्राथमिकताओं का प्रबंधन करें',
    'settings.accountInfo': 'खाता जानकारी',
    'settings.firstName': 'पहला नाम',
    'settings.lastName': 'अंतिम नाम',
    'settings.emailAddress': 'ईमेल पता',
    'settings.accountId': 'खाता आईडी',
    'settings.privacy': 'गोपनीयता और सुरक्षा',
    'settings.dataRetention': 'डेटा संरक्षण अवधि',
    'settings.shareAnalytics': 'अनाम एनालिटिक्स साझा करें',
    'settings.emailPreview': 'ईमेल सामग्री पूर्वावलोकन',
    'settings.appPrefs': 'एप्लिकेशन प्राथमिकताएँ',
    'settings.theme': 'थीम',
    'settings.language': 'भाषा',
    'settings.timezone': 'समय क्षेत्र',
    'settings.emailsPerPage': 'प्रति पृष्ठ ईमेल',
    'settings.save': 'सेटिंग्स सहेजें',
    'settings.theme.light': 'हल्का',
    'settings.theme.dark': 'गहरा',
    'settings.theme.auto': 'स्वत: (सिस्टम)',
    'settings.timezone.auto': 'स्वत: पहचान',
    'settings.timezone.utc': 'UTC',
    'settings.timezone.est': 'यूएस/ईस्टर्न',
    'settings.timezone.pst': 'यूएस/पैसिफिक',
    'settings.quickActions': 'त्वरित क्रियाएँ',
    'settings.signOut': 'साइन आउट',
    'settings.danger': 'खतरे का क्षेत्र',
    'settings.deleteAccount': 'खाता हटाएँ',
    'settings.support': 'सहायता',
    'settings.privacyPolicy': 'गोपनीयता नीति',
    'settings.terms': 'सेवा की शर्तें',
    'settings.memberSince': 'से सदस्य',
    'settings.retention.3months': '3 महीने',
    'settings.retention.6months': '6 महीने',
    'settings.retention.1year': '1 वर्ष',
    'settings.retention.2years': '2 वर्ष',
    'settings.retention.forever': 'हमेशा के लिए रखें',
    'settings.shareAnalytics.help': 'उपयोग डेटा साझा करके ScrapIt को बेहतर बनाने में मदद करें',
    'settings.emailPreview.help': 'इंटरफ़ेस में ईमेल स्निपेट दिखाएँ',
  }
};

export function getPrefs(): AppPreferences {
  try {
    const raw = localStorage.getItem('app_prefs');
    const parsed = raw ? JSON.parse(raw) : {};
    return parsed.preferences || {};
  } catch {
    return {};
  }
}

export function setPrefs(prefs: AppPreferences) {
  try {
    const raw = localStorage.getItem('app_prefs');
    const parsed = raw ? JSON.parse(raw) : {};
    parsed.preferences = { ...(parsed.preferences || {}), ...prefs };
    localStorage.setItem('app_prefs', JSON.stringify(parsed));
    // Update document language and direction
    try {
      const lang = parsed.preferences?.language || 'en';
      const dir = lang === 'ar' ? 'rtl' : 'ltr';
      document.documentElement.setAttribute('lang', lang);
      document.documentElement.setAttribute('dir', dir);
    } catch {}
    window.dispatchEvent(new CustomEvent('app:prefs-changed', { detail: parsed.preferences }));
  } catch {}
}

export function onPrefsChange(handler: (prefs: AppPreferences) => void) {
  const listener = (e: Event) => {
    const custom = e as CustomEvent<AppPreferences>;
    handler(custom.detail || getPrefs());
  };
  window.addEventListener('app:prefs-changed', listener as EventListener);
  return () => window.removeEventListener('app:prefs-changed', listener as EventListener);
}

export function t(key: string): string {
  const lang = getPrefs().language || 'en';
  const table = translations[lang] || translations.en;
  return table[key] || translations.en[key] || key;
}

export function resolveTimeZone(pref?: AppPreferences['timezone']): string | undefined {
  if (!pref || pref === 'auto') return undefined;
  if (pref === 'utc') return 'UTC';
  if (pref === 'pst') return 'America/Los_Angeles';
  if (pref === 'est') return 'America/New_York';
  return undefined;
}

export function tzOffsetMinutes(pref?: AppPreferences['timezone']): number | undefined {
  if (!pref || pref === 'auto') return undefined;
  if (pref === 'utc') return 0;
  if (pref === 'pst') return 480;
  if (pref === 'est') return 300;
  return undefined;
}


// Initialize document language and direction on load
try {
  const initial = getPrefs();
  const lang = initial.language || 'en';
  const dir = lang === 'ar' ? 'rtl' : 'ltr';
  document.documentElement.setAttribute('lang', lang);
  document.documentElement.setAttribute('dir', dir);
} catch {}
